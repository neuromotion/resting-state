(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return d});var r=n(4),o=n(19),a=n(22),c=n.n(a),i=!1;if(r.b.USE_ELECTRON){var s=window.require("electron");i=s.ipcRenderer}var u=function(){var e=r.b.USE_PHOTODIODE?"visible":"invisible";return'<div class="photodiode-box '.concat(e,'" id="photodiode-box">\n\t\t\t\t\t\t\t\t\t<span id="photodiode-spot" class="photodiode-spot"></span>\n  \t\t\t\t\t\t\t\t</div>')},d=function(e){if(r.b.USE_PHOTODIODE){var t=e;e<o.eventCodes.open_task&&(t=1),function e(t,n){n>0&&function(e,t){c()(".photodiode-spot").css({"background-color":"white"}),setTimeout(function(){c()(".photodiode-spot").css({"background-color":"black"}),t()},e)}(t,function(){setTimeout(function(){e(t,n-1)},t)})}(40,t),i&&i.send("trigger",e)}}},19:function(e,t){e.exports={eventCodes:{test_connect:32,open_task:12,left:1,right:2,up:3,down:4,center:5,blink:{start:6,stop:7},close:{start:8,stop:9},rest:{start:10,stop:11}}}},20:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return u}),n.d(t,"d",function(){return a});var r,o=n(15),a=function(e){document.getElementById(e).classList.add("nocursor")},c=function(e){return new Promise(function(t){return setTimeout(t,e)})},i=((r=n(70)).keys().map(r),function(){var e=o.jsPsych.turk.turkInfo();return"".concat(e.workerId,":").concat(e.assignmentId)}),s=function(){return function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var r=t[n].split("=");if(decodeURIComponent(r[0])===e)return decodeURIComponent(r[1])}}("PROLIFIC_PID")},u=function(e){var t=new AudioContext,n=t.createOscillator(),r=t.createGain();n.type=e.type,n.connect(r),n.frequency.setValueAtTime(e.frequency,0),console.log(t.currentTime),r.connect(t.destination),n.start(),n.stop(t.currentTime+.4)}},21:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"<div class=".concat(n?"center_container":t?"main-prompt":"main",">").concat(e,"</div>")}},36:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return _}),n.d(t,"a",function(){return f});var r=n(13),o=n.n(r),a=n(42),c=n(17),i=n(4),s=n(14),u=n(21),d=n(15),l=!1;if(i.b.USE_ELECTRON){var p=window.require("electron");l=p.ipcRenderer}var _=function(){document.title=i.e;var t='\n  <div class="d-flex flex-column align-items-center">\n  <p>'.concat(i.d.instructions.camera,'</p>\n  <video id="camera" width="640" height="480" autoplay></video>\n  </div>\n  ');return{type:"html_button_response",stimulus:Object(u.a)(t,!0)+Object(s.b)(),choices:[i.d.prompt.continue.button],response_ends_trial:!0,on_load:function(){var t=d.jsPsych.data.get().values()[0].participant_id,n=document.getElementById("camera"),r=function(r,o){console.log(r),"cameraCapture"===o&&(n.srcObject=r);var a=[];window[o]=new MediaRecorder(r,{mimeType:"video/webm"}),window[o].addEventListener("dataavailable",function(e){e.data.size>0&&a.push(e.data)}),window[o].addEventListener("stop",function(){!function(t,n,r){var o=new FileReader,a="pid_".concat(r,"_").concat(n,"_").concat(Date.now(),".webm");o.onload=function(){if(2===o.readyState){var n=new e(o.result);l.send("save_video",a,n),console.log("Saving ".concat(JSON.stringify({fileName:a,size:t.size})))}},o.readAsArrayBuffer(t)}(new Blob(a),o,t)})};navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){return r(e,"cameraCapture")}),window.require("electron").desktopCapturer.getSources({types:["window"]}).then(function(){var e=Object(c.a)(o.a.mark(function e(t){var n,c,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(a.a)(t);try{for(n.s();!(c=n.n()).done;)(s=c.value).name===i.e&&navigator.mediaDevices.getUserMedia({video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s.id}}}).then(function(e){r(e,"screenCapture")}).catch(function(e){return console.log(e)})}catch(o){n.e(o)}finally{n.f()}case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},on_finish:function(){if(i.b.USE_CAMERA)try{window.cameraCapture.start(),window.screenCapture.start()}catch(e){window.alert("Camera permissions were not given, if you choose to proceed, your recording will not be saved. Please restart the experiment after you have given permission.")}}}},f=function(e){return{type:"html_keyboard_response",stimulus:Object(u.a)("<h1>".concat(i.d.task.recording_end,"</h1>"),!0)+Object(s.b)(),trial_duration:e,on_load:function(){if(i.b.USE_CAMERA){console.log("finished");try{window.cameraCapture.stop(),window.screenCapture.stop()}catch(e){window.alert("Your video recording was not saved")}}}}}}).call(this,n(75).Buffer)},4:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"d",function(){return h}),n.d(t,"b",function(){return O}),n.d(t,"a",function(){return u});var r=n(15),o=n(29),a=n.n(o),c=n(19);n.d(t,"c",function(){return c.eventCodes});var i=n(26),s=n(20),u={frequency:100*(c.eventCodes.open_task-9),type:"sine"},d="honeycomb template",l=!r.jsPsych.turk.turkInfo().outsideTurk,p=Object(s.b)()&&!l,_=!0,f="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_FIREBASE;try{window.require("electron")}catch(P){_=!1}var E="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_VIDEO&&_,m=_,b=_,h=n(73);if(!_){var v=n(74);a.a.merge(h,v)}var O=Object(i.init)({USE_PHOTODIODE:b,USE_EEG:m,USE_ELECTRON:_,USE_MTURK:l,USE_VOLUME:!0,USE_CAMERA:E,USE_PROLIFIC:p,USE_FIREBASE:f})},43:function(e){e.exports={a:"2.3.0"}},45:function(e,t,n){e.exports=n(88)},52:function(e,t,n){},54:function(e,t,n){},70:function(e,t,n){var r={"./blue_payout_correct_10.png":71,"./blue_payout_correct_100.png":72};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id=70},71:function(e,t,n){e.exports=n.p+"static/media/blue_payout_correct_10.f515a81e.png"},72:function(e,t,n){e.exports=n.p+"static/media/blue_payout_correct_100.ae2416c7.png"},73:function(e){e.exports={task:{name:"Resting State",end:"This experiment has ended.",recording_end:"Your recording has ended."},prompt:{continue:{press:"Press any key to continue.",button:"Continue"},focus:"Make sure the photodiode is covering the spot and any external recordings have begun before continuing.",fullscreen:"Press 'cmd + ctrl + F' to toggle Fullscreen.",zoom:"Zoom in to enlarge the screen.",setting_up:"Setting up task..."},welcome:{large_window:"Please make this window as large as possible.",message:"Instructions"},userid:{set:"Please enter participant ID."},eventMarker:{found:"Note: event marker found.",not_found:"Note: no event marker found."},instructions:{moving_dot:"Try to relax and follow the dot on the screen as it moves. Try to relax your shoulders, don't clench your jaw, and try not to move. Movements affect the quality of the recordings.",blink:'For this next section, start blinking when you hear a "beep", and stop when you hear another "beep".',close_eyes:'For this next section, close your eyes when you hear a "beep", and open when you hear another "beep". ',fixate:"For the remaining minute and a half, fixate on the dot in the middle of the screen and try to relax.",align_photodiode:"Make sure the photodiode is aligned and the EEG recording has begun before continuing.",adjust_volume:"Set tablet volume to 50/100.",camera:"Make sure the camera is pointing to you and your face is within the camera area."},blink:"Blink.",close:"Close your eyes."}},74:function(e){e.exports={welcome:{message:"Welcome to the NEURO experiment."},userid:{set:"Setting up user ID."}}},88:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n.n(r),a=n(41),c=n.n(a),i=(n(52),n(13)),s=n.n(i),u=n(17),d=n(18),l=(n(54),n(55),n(56),n(24)),p=n(44);var f=function(e){var t=e.onLogin,n=e.envParticipantId,a=e.envStudyId,c=e.validationFunction,i=Object(r.useState)(""),s=Object(d.a)(i,2),u=s[0],_=s[1],f=Object(r.useState)(""),E=Object(d.a)(f,2),m=E[0],b=E[1],h=Object(r.useState)(!1),v=Object(d.a)(h,2),O=v[0],P=v[1];return Object(r.useEffect)(function(){_(n),b(a)},[n,a]),o.a.createElement("div",{className:"centered-h-v"},o.a.createElement("div",{className:"width-50"},O?o.a.createElement("div",{className:"alert alert-danger",role:"alert"},"The participant ID and study ID do not match"):null,o.a.createElement(l.a,{className:"centered-h-v",onSubmit:function(e){e.preventDefault(),c(u,m).then(function(e){e?t(e,m,u):P(!0)})}},o.a.createElement(l.a.Group,{className:"width-100",size:"lg",controlId:"participantId"},o.a.createElement(l.a.Label,null,"Participant ID"),o.a.createElement(l.a.Control,{autoFocus:!0,type:"participantId",value:u,onChange:function(e){return _(e.target.value)}})),o.a.createElement(l.a.Group,{className:"width-100",size:"lg",controlId:"studyId"},o.a.createElement(l.a.Label,null,"Study ID"),o.a.createElement(l.a.Control,{type:"studyId",value:m,onChange:function(e){return b(e.target.value)}})),o.a.createElement(p.a,{style:{width:"100%"},block:!0,size:"lg",type:"submit",disabled:!(u.length>0&&m.length>0)},"Log In"))))},E=n(15),m=n(4),b=n(14),h=n(21),v=function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'<span style="color: green;">'.concat(m.d.eventMarker.found,"</span>"));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),O=function(){return{type:"html_button_response",stimulus:Object(h.a)("<div><h2 id='usb-alert'></h2></div>",!0)+Object(b.b)(),prompt:["<br><h3>".concat(m.d.prompt.focus,"</h3>")],choices:[m.d.prompt.continue.button],on_load:function(){return v().then(function(e){return document.getElementById("usb-alert").innerHTML=e})}}},P=n(20),w=function(){return{type:"html_keyboard_response",stimulus:Object(h.a)("<h1>".concat(m.d.prompt.setting_up,"</h1>"),!0)+Object(b.b)(),trial_duration:2e3,on_load:function(){Object(b.a)(m.c.open_task),Object(P.a)(m.a)}}},y=n(26),g=function(e){return{type:"html_keyboard_response",stimulus:Object(h.a)("\n    <div class='instructions'>\n    <h1>".concat(e,"</h1>\n    </div>\n    "),!0),prompt:m.d.prompt.continue.press,response_ends_trial:!0}},A=[Object(y.showMessage)(m.b,{responseType:"html_button_response",message:m.d.task.name,responseEndsTrial:!0,buttons:[m.d.prompt.continue.button]})];m.b.USE_PHOTODIODE&&(A.push(O()),A.push(w())),A.push({type:"html_keyboard_response",stimulus:Object(h.a)("\n  <div class='instructions'>\n  <h1>".concat(m.d.instructions.moving_dot,"</h1>\n  </div>\n  "),!0),prompt:m.d.prompt.continue.press,response_ends_trial:!0});var U={type:"html_keyboard_response",stimulus:"",timeline:A},j=n(36),C='<div id="fixation-container"><div id="fixation-dot"> </div></div>',S=n(22),T=n.n(S),I=function(e){T()("#fixation-container").attr("class","move-".concat(e))},R=function(){var e=new AudioContext,t=e.createOscillator(),n=e.createGain();t.type="sine",t.connect(n),n.connect(e.destination),t.start(),n.gain.exponentialRampToValueAtTime(1e-7,e.currentTime+1)},k=function(e){return new Promise(function(t){return setTimeout(t,e)})},D=n(19),L=function(){var e=Object(u.a)(s.a.mark(function e(t,n,r,o,a){var c,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(){return Date.now()-r},i=o[n],e.next=4,k(t);case 4:I(n),Object(b.a)(i),a.push({code:i,rt:c(),timestamp:Date.now()});case 7:case"end":return e.stop()}},e)}));return function(t,n,r,o,a){return e.apply(this,arguments)}}(),x=function(e){var t=C+Object(b.b)(),n=function(){var e=Object(u.a)(s.a.mark(function e(t,n,r,o){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"left"===t&&(n.push({code:o.center,rt:0,timestamp:Date.now()}),Object(b.a)(o.center)),e.next=3,L(5e3,t,r,o,n);case 3:return e.next=5,L(2e3,"center",r,o,n);case 5:return e.next=7,L(2e3,t,r,o,n);case 7:return e.next=9,L(2e3,"center",r,o,n);case 9:return e.next=11,L(2e3,t,r,o,n);case 11:return e.next=13,L(2e3,"center",r,o,n);case 13:console.log(n);case 14:case"end":return e.stop()}},e)}));return function(t,n,r,o){return e.apply(this,arguments)}}();return{type:"call_function",async:!0,func:function(r){Object(P.d)("experiment");var o=Date.now(),a=[];document.getElementById("jspsych-content").innerHTML=t;var c=T()(".jspsych-content-wrapper");c.attr("class","fixation-container"),n(e,a,o,D.eventCodes),setTimeout(function(){return r({direction:e,code:D.eventCodes[e],start:o,data:a})},"down"===e?17e3:15100),c.attr("class","jspsych-content-wrapper")}}},N=function(e){var t='<div id="dot-container"><h3>'.concat(m.d[e],"</h3></div>")+Object(b.b)();return{type:"html_keyboard_response",choices:E.jsPsych.NO_KEYS,stimulus:t,trial_duration:11e3,on_load:function(){var t=Object(u.a)(s.a.mark(function t(){var n,r,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Date.now(),r=D.eventCodes[e],o=[],Object(b.a)(r.start),R(),o.push({trial:e,code:r.start,rt:Date.now()-n}),t.next=8,k(1e4);case 8:Object(b.a)(r.stop),R(),o.push({trial:e,code:r.stop,rt:Date.now()-n}),E.jsPsych.data.write(o);case 12:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}},M=function(e){var t=C+Object(b.b)(),n=m.c.rest.start,r=m.c.rest.stop;return{type:"html_keyboard_response",choices:E.jsPsych.NO_KEYS,stimulus:t,response_ends_trial:!1,trial_duration:e,on_load:function(){var e=Object(u.a)(s.a.mark(function e(){var t,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Date.now(),o=[],Object(b.a)(n),o.push({code:n,rt:Date.now()-t}),e.next=6,k(9e4);case 6:Object(b.a)(r),o.push({code:r,rt:Date.now()-n}),E.jsPsych.data.write(o);case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}},F=[U,x("left"),x("right"),x("up"),x("down"),g(m.d.instructions.blink),N("blink"),g(m.d.instructions.close_eyes),N("close"),g(m.d.instructions.fixate),M(91e3)];m.b.USE_CAMERA&&(F.splice(1,0,Object(j.b)()),F.push(Object(j.a)(5e3))),F.push(Object(y.showMessage)(m.b,{duration:5e3,message:m.d.task.end}));var V=F;var B=function(e){var t=e.dataUpdateFunction,n=e.dataFinishFunction;return o.a.createElement("div",{className:"App"},o.a.createElement(E.Experiment,{settings:{timeline:V,on_data_update:function(e){return t(e)},on_finish:function(e){return n(e)}}}))},H=n(32);n(84);n(85).config();var G={apiKey:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_apiKey,authDomain:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_authDomain,databaseURL:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_databaseURL,projectId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_projectId||"no-firebase",storageBucket:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_storageBucket,messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_messagingSenderId,appId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_appId},q=H.a.initializeApp(G).firestore();"localhost"===window.location.hostname&&q.useEmulator("localhost",8080);var z=function(e,t,n){return q.collection("participant_responses").doc(t).collection("participants").doc(e).collection("data").doc(n).set({start_time:n,app_version:window.navigator.appVersion,app_platform:window.navigator.platform,results:[]}).then(function(){return!0}).catch(function(e){return!1})},K=function(e){console.log(e);var t=e.participant_id,n=e.study_id,r=e.start_date;q.collection("participant_responses").doc(n).collection("participants").doc(t).collection("data").doc(r).update("results",H.a.firestore.FieldValue.arrayUnion(e))},Y=(H.a,n(43));var J=function(){var e=(new Date).toISOString(),t=Object(r.useState)(!1),n=Object(d.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(!1),l=Object(d.a)(i,2),p=l[0],b=l[1],h=Object(r.useState)(!1),v=Object(d.a)(h,2),O=v[0],w=v[1],y=Object(r.useState)(""),g=Object(d.a)(y,2),A=g[0],U=g[1],j=Object(r.useState)(""),C=Object(d.a)(j,2),S=C[0],T=C[1],I=Object(r.useState)("default"),R=Object(d.a)(I,2),k=R[0],D=R[1],L=Object(r.useState)(!1),x=Object(d.a)(L,2),N=x[0],M=x[1],F=new URLSearchParams(window.location.search),V=function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),H=function(e){},G=Object(r.useCallback)(function(t,n,r){t&&E.jsPsych.data.addProperties({participant_id:r,study_id:n,start_date:e,task_version:Y.a}),c(t)},[e]);return Object(r.useEffect)(function(){if(console.log("Turk:",m.b.USE_MTURK),console.log("Firebase:",m.b.USE_FIREBASE),console.log("Prolific:",m.b.USE_PROLIFIC),console.log("Electron:",m.b.USE_ELECTRON),console.log("Video:",m.b.USE_CAMERA),console.log("Volume:",m.b.USE_VOLUME),console.log("Event Marker:",m.b.USE_EEG),console.log("Photodiode:",m.b.USE_PHOTODIODE),m.b.USE_ELECTRON){var e=window.require("electron").ipcRenderer;b(e),e.send("updateEnvironmentVariables",m.b);var t=e.sendSync("syncCredentials");t.envParticipantId&&U(t.envParticipantId),t.envStudyId&&T(t.envStudyId),D("desktop")}else if(m.b.USE_MTURK){window.lodash=_.noConflict();var n=Object(P.c)();w(new PsiTurk(n,"/complete")),D("mturk"),G(!0,"mturk",n)}else if(m.b.USE_PROLIFIC){var r=Object(P.b)();m.b.USE_FIREBASE&&r?(D("firebase"),G(!0,"prolific",r)):M(!0)}else if(m.b.USE_FIREBASE){D("firebase");var o=F.get("participantID"),a=F.get("studyID");o&&U(o),a&&T(a)}else M(!0)},[]),N?o.a.createElement("div",{className:"centered-h-v"},o.a.createElement("div",{className:"width-50 alert alert-danger"},"Please ask your task provider to enable firebase.")):o.a.createElement(o.a.Fragment,null,a?o.a.createElement(B,{dataUpdateFunction:{desktop:function(e){p.send("data",e)},firebase:function(e){K(e)},mturk:function(e){O.recordTrialData(e)},default:H}[k],dataFinishFunction:{desktop:function(){p.send("end","true")},mturk:function(){!function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return O.saveData(),e.next=3,Object(P.e)(5e3);case 3:O.completeHIT();case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},firebase:H,default:H}[k]}):o.a.createElement(f,{validationFunction:{desktop:V,default:V,firebase:function(t,n){return z(t,n,e)}}[k],envParticipantId:A,envStudyId:S,onLogin:G}))};c.a.render(o.a.createElement(J,null),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.f3d1d977.chunk.js.map